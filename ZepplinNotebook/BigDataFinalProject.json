{"paragraphs":[{"text":"val color_RDD = sc.textFile(\"/Users/ellise/Desktop/untitled folder 6/CSYE7200-SPRING2018-TEAM5/color.txt\")\nval brand_RDD = sc.textFile(\"/Users/ellise/Desktop/untitled folder 6/CSYE7200-SPRING2018-TEAM5/brand.txt\")\nval price_RDD = sc.textFile(\"/Users/ellise/Desktop/untitled folder 6/CSYE7200-SPRING2018-TEAM5/price.txt\")","user":"anonymous","dateUpdated":"2018-04-18T13:41:13-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"color_RDD: org.apache.spark.rdd.RDD[String] = /Users/ellise/Desktop/untitled folder 6/CSYE7200-SPRING2018-TEAM5/color.txt MapPartitionsRDD[591] at textFile at <console>:32\nbrand_RDD: org.apache.spark.rdd.RDD[String] = /Users/ellise/Desktop/untitled folder 6/CSYE7200-SPRING2018-TEAM5/brand.txt MapPartitionsRDD[593] at textFile at <console>:32\nprice_RDD: org.apache.spark.rdd.RDD[String] = /Users/ellise/Desktop/untitled folder 6/CSYE7200-SPRING2018-TEAM5/price.txt MapPartitionsRDD[595] at textFile at <console>:32\n"}]},"apps":[],"jobName":"paragraph_1524010850000_-1272335416","id":"20180417-202050_1769227383","dateCreated":"2018-04-17T20:20:50-0400","dateStarted":"2018-04-18T13:41:13-0400","dateFinished":"2018-04-18T13:41:13-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7273"},{"text":"import org.apache.spark.rdd.RDD\ncase class Color(color: String)\ncase class Brand(brand: String)\ncase class Price(price: String)\n\ndef seperate(lines: RDD[String],separator: String) = {\n    lines.flatMap(_.split(separator))\n  }\n  \ndef safeStringToDouble(str: String): Option[Double] = try {\n    Some(str.toDouble)\n  } catch {\n    case e: NumberFormatException => None\n  }\n","user":"anonymous","dateUpdated":"2018-04-18T13:42:19-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.rdd.RDD\ndefined class Color\ndefined class Brand\ndefined class Price\nseperate: (lines: org.apache.spark.rdd.RDD[String], separator: String)org.apache.spark.rdd.RDD[String]\nsafeStringToDouble: (str: String)Option[Double]\n"}]},"apps":[],"jobName":"paragraph_1524011071358_525366331","id":"20180417-202431_508576256","dateCreated":"2018-04-17T20:24:31-0400","dateStarted":"2018-04-18T13:41:16-0400","dateFinished":"2018-04-18T13:41:16-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7274"},{"text":"val colors = seperate(color_RDD, \",\").map(s=>Color(s))\nval brands = seperate(brand_RDD, \",\").map(s=>Brand(s))\nval priceDouble = seperate(price_RDD, \",\").map(x=>safeStringToDouble(x)).flatMap(x => x)\nval priceMax = priceDouble.max\nval interval = (priceMax - priceDouble.min)/10\ndef vectorizedListOfDoubleRDD(priceDouble: Double): String = {\n      val priceResult = priceDouble match {\n        case x if (priceMax - 1*interval)<x & x<=(priceMax) => \"(%1.2f - %1.2f]\".format(priceMax - 1*interval, priceMax)\n        case x if (priceMax - 2*interval)<x & x<=(priceMax - 1*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 2*interval, priceMax - 1*interval)\n        case x if (priceMax - 3*interval)<x & x<=(priceMax - 2*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 3*interval, priceMax - 2*interval)\n        case x if (priceMax - 4*interval)<x & x<=(priceMax - 3*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 4*interval, priceMax - 3*interval)\n        case x if (priceMax - 5*interval)<x & x<=(priceMax - 4*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 5*interval, priceMax - 4*interval)\n        case x if (priceMax - 6*interval)<x & x<=(priceMax - 5*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 6*interval, priceMax - 5*interval)\n        case x if (priceMax - 7*interval)<x & x<=(priceMax - 6*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 7*interval, priceMax - 6*interval)\n        case x if (priceMax - 8*interval)<x & x<=(priceMax - 7*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 8*interval, priceMax - 7*interval)\n        case x if (priceMax - 9*interval)<x & x<=(priceMax - 8*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 9*interval, priceMax - 8*interval)\n        case x if (priceMax - 10*interval)<=x & x<=(priceMax - 9*interval) => \"(%1.2f - %1.2f]\".format(priceMax - 10*interval, priceMax - 9*interval)\n      }\n      priceResult\n    }\nval prices = priceDouble.map(vectorizedListOfDoubleRDD).map(s=>Price(s))","user":"anonymous","dateUpdated":"2018-04-18T13:43:35-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"colors: org.apache.spark.rdd.RDD[Color] = MapPartitionsRDD[617] at map at <console>:39\nbrands: org.apache.spark.rdd.RDD[Brand] = MapPartitionsRDD[619] at map at <console>:39\npriceDouble: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[622] at flatMap at <console>:39\npriceMax: Double = 434.99\ninterval: Double = 43.499\nvectorizedListOfDoubleRDD: (priceDouble: Double)String\nprices: org.apache.spark.rdd.RDD[Price] = MapPartitionsRDD[624] at map at <console>:49\n"}]},"apps":[],"jobName":"paragraph_1524011147448_1392095045","id":"20180417-202547_745521456","dateCreated":"2018-04-17T20:25:47-0400","dateStarted":"2018-04-18T13:43:35-0400","dateFinished":"2018-04-18T13:43:36-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7275"},{"text":"colors.toDF().registerTempTable(\"colors\")\nbrands.toDF().registerTempTable(\"brands\")\nprices.toDF().registerTempTable(\"prices\")","user":"anonymous","dateUpdated":"2018-04-18T13:43:39-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nwarning: there was one deprecation warning; re-run with -deprecation for details\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1524011404279_-1159607277","id":"20180417-203004_931081153","dateCreated":"2018-04-17T20:30:04-0400","dateStarted":"2018-04-18T13:43:39-0400","dateFinished":"2018-04-18T13:43:40-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7276"},{"text":"%sql select Color, count(*) FROM colors GROUP BY Color\n                                        Having count(*) > 10\n                                        ORDER BY Color\n                                    ","user":"anonymous","dateUpdated":"2018-04-18T15:38:51-0400","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"Color","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(1)","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Color\tcount(1)\n\t12\na\t12\narmy green\t13\nblack\t413\nblue\t90\nbrown\t16\ncamouflage\t13\ndark blue\t13\ndark gray\t19\ngold\t12\ngray\t58\ngreen\t26\ngrey\t16\nkhaki\t26\nlight blue\t15\nmulticolor\t15\nnavy\t39\npink\t29\nred\t30\nsilver\t25\nwhite\t116\nyellow\t31\n"}]},"apps":[],"jobName":"paragraph_1524011991857_1335945252","id":"20180417-203951_911846086","dateCreated":"2018-04-17T20:39:51-0400","dateStarted":"2018-04-18T12:51:42-0400","dateFinished":"2018-04-18T12:51:42-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7277"},{"text":"%sql select Color, count(*) FROM colors GROUP BY Color\n                                        Having count(*) > 20 and Color != \"black\" and Color != \"a\"\n                                        ORDER BY Color","user":"anonymous","dateUpdated":"2018-04-18T15:52:20-0400","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Color\tcount(1)\nblue\t90\ngray\t58\ngreen\t26\nkhaki\t26\nnavy\t39\npink\t29\nred\t30\nsilver\t25\nwhite\t116\nyellow\t31\n"}]},"apps":[],"jobName":"paragraph_1524012047606_587486048","id":"20180417-204047_1828650051","dateCreated":"2018-04-17T20:40:47-0400","dateStarted":"2018-04-18T15:52:20-0400","dateFinished":"2018-04-18T15:52:21-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7278"},{"text":"%sql select Brand, count(*) FROM brands GROUP BY Brand\n                                        Having count(*) > 10\n                                        ORDER BY Brand\n","user":"anonymous","dateUpdated":"2018-04-18T16:45:56-0400","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Brand\tcount(1)\nAIMTOPPY\t12\nDAOROKA MEN PANTS\t12\nEABERN\t15\nHAN SHI\t22\nHAORICU\t30\nHATOPPY\t11\nHEMLOCK\t21\nJUSHYE\t20\nLEE\t14\nMINISOYA\t19\nNO NONSENSE\t13\nNURSE MATES\t13\nRAFAELLA\t11\nWEIXINBUY\t13\nWEUIE WOMEN'S CLOTHING\t31\n"}]},"apps":[],"jobName":"paragraph_1524014002573_862168283","id":"20180417-211322_437034330","dateCreated":"2018-04-17T21:13:22-0400","dateStarted":"2018-04-18T12:47:49-0400","dateFinished":"2018-04-18T12:47:50-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7279"},{"text":"%sql SELECT Price, COUNT(*) from prices GROUP BY Price\n                                        ORDER BY COUNT(*) DESC\n","user":"anonymous","dateUpdated":"2018-04-18T13:46:17-0400","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Price\tcount(1)\n(0.00 - 43.50]\t18767\n(43.50 - 87.00]\t1327\n(87.00 - 130.50]\t427\n(174.00 - 217.50]\t132\n(130.50 - 174.00]\t131\n(217.50 - 260.99]\t68\n(260.99 - 304.49]\t50\n(304.49 - 347.99]\t29\n(391.49 - 434.99]\t12\n(347.99 - 391.49]\t2\n"}]},"apps":[],"jobName":"paragraph_1524014596320_-111757066","id":"20180417-212316_1455021144","dateCreated":"2018-04-17T21:23:16-0400","dateStarted":"2018-04-18T13:46:17-0400","dateFinished":"2018-04-18T13:46:17-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7281"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524067748869_366049417","id":"20180418-120908_521517773","dateCreated":"2018-04-18T12:09:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7284","text":"%sql SELECT Price, COUNT(*) from prices GROUP BY Price\n                                        Having Price != \"(0.00 - 43.50]\" and COUNT(*) >50\n                                        \n","dateUpdated":"2018-04-18T17:24:59-0400","dateFinished":"2018-04-18T17:24:59-0400","dateStarted":"2018-04-18T17:24:59-0400","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Price\tcount(1)\n(174.00 - 217.50]\t132\n(43.50 - 87.00]\t1327\n(217.50 - 260.99]\t68\n(87.00 - 130.50]\t427\n(130.50 - 174.00]\t131\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524085934267_-877596863","id":"20180418-171214_634094393","dateCreated":"2018-04-18T17:12:14-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11342"}],"name":"BigDataFinalProject","id":"2DCPVJGTD","angularObjects":{"2DCU83REJ:shared_process":[],"2DATNT8CP:shared_process":[],"2DBN1KA6B:shared_process":[],"2DDXJGH1D:shared_process":[],"2DAEENTYU:shared_process":[],"2DCUKR53S:shared_process":[],"2DCZPG8YZ:shared_process":[],"2DD98YP3X:shared_process":[],"2DAFJJ2ST:shared_process":[],"2DBFNYGSP:shared_process":[],"2DATVN8VH:shared_process":[],"2DB58P7MC:shared_process":[],"2DEAFHYDJ:shared_process":[],"2DE3KQ5FY:shared_process":[],"2DADUFQ7T:shared_process":[],"2DCMMSTQ5:shared_process":[],"2DCVDRDPR:shared_process":[],"2DDCZ15Y2:shared_process":[],"2DCU1D6N6:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}